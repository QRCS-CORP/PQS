\doxysection{C\+:/\+Users/stepp/\+Documents/\+Visual Studio 2022/\+Projects/\+C/\+PQS/\+PQS/server.h File Reference}
\hypertarget{server_8h}{}\label{server_8h}\index{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/PQS/PQS/server.h@{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/PQS/PQS/server.h}}


PQS Server functions.  


{\ttfamily \#include "{}pqs.\+h"{}}\newline
{\ttfamily \#include "{}../../\+QSC/\+QSC/rcs.\+h"{}}\newline
{\ttfamily \#include "{}../../\+QSC/\+QSC/socketserver.\+h"{}}\newline
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{server_8h_a4b3434bd162765ecc049a007fa583cb8}{PQS\+\_\+\+SERVER\+\_\+\+PAUSE\+\_\+\+INTERVAL}}~100
\begin{DoxyCompactList}\small\item\em The pause interval used by the server pause function. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
PQS\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{server_8h_a464f77940b0c4be43e1f747627c4433f}{pqs\+\_\+server\+\_\+pause}} (void)
\begin{DoxyCompactList}\small\item\em Pause the server, suspending new joins. \end{DoxyCompactList}\item 
PQS\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{server_8h_a77be24f2908514353a01634eb3942e48}{pqs\+\_\+server\+\_\+quit}} (qsc\+\_\+socket \texorpdfstring{$\ast$}{*}source)
\begin{DoxyCompactList}\small\item\em Quit the server, closing all connections. \end{DoxyCompactList}\item 
PQS\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{server_8h_a21ed8451507f44e962e1a24b7d25e5a2}{pqs\+\_\+server\+\_\+resume}} (void)
\begin{DoxyCompactList}\small\item\em Resume the server listener function from a paused state. \end{DoxyCompactList}\item 
PQS\+\_\+\+EXPORT\+\_\+\+API \mbox{\hyperlink{pqs_8h_a2c9a6e74f4ff60d25602074a1d70a4e2}{pqs\+\_\+errors}} \mbox{\hyperlink{server_8h_a08491dc116cdd550407bc040d555cc26}{pqs\+\_\+server\+\_\+start\+\_\+ipv4}} (qsc\+\_\+socket \texorpdfstring{$\ast$}{*}source, const \mbox{\hyperlink{structpqs__server__signature__key}{pqs\+\_\+server\+\_\+signature\+\_\+key}} \texorpdfstring{$\ast$}{*}kset, void(\texorpdfstring{$\ast$}{*}receive\+\_\+callback)(\mbox{\hyperlink{structpqs__connection__state}{pqs\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t), void(\texorpdfstring{$\ast$}{*}disconnect\+\_\+callback)(\mbox{\hyperlink{structpqs__connection__state}{pqs\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}))
\begin{DoxyCompactList}\small\item\em Start the IPv4 multi-\/threaded server. \end{DoxyCompactList}\item 
PQS\+\_\+\+EXPORT\+\_\+\+API \mbox{\hyperlink{pqs_8h_a2c9a6e74f4ff60d25602074a1d70a4e2}{pqs\+\_\+errors}} \mbox{\hyperlink{server_8h_a40ea87dcbc4b998bb1fab22730713822}{pqs\+\_\+server\+\_\+start\+\_\+ipv6}} (qsc\+\_\+socket \texorpdfstring{$\ast$}{*}source, const \mbox{\hyperlink{structpqs__server__signature__key}{pqs\+\_\+server\+\_\+signature\+\_\+key}} \texorpdfstring{$\ast$}{*}kset, void(\texorpdfstring{$\ast$}{*}receive\+\_\+callback)(\mbox{\hyperlink{structpqs__connection__state}{pqs\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t), void(\texorpdfstring{$\ast$}{*}disconnect\+\_\+callback)(\mbox{\hyperlink{structpqs__connection__state}{pqs\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}))
\begin{DoxyCompactList}\small\item\em Start the IPv6 multi-\/threaded server. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
PQS Server functions. 

This header defines the functions used to implement the Post Quantum Shell (PQS) server. These functions enable the server to pause accepting new connections, resume listening, shut down (quitting) by closing all active connections, and to start the multi-\/threaded server on both IPv4 and IPv6 networks.

The multi-\/threaded server functions require a pointer to the listener socket as well as a pointer to the server\textquotesingle{}s private key (QSMP private key) used for secure communications. Callback functions are provided to process incoming client data streams and to handle client disconnections. 

\doxysubsection{Macro Definition Documentation}
\Hypertarget{server_8h_a4b3434bd162765ecc049a007fa583cb8}\index{server.h@{server.h}!PQS\_SERVER\_PAUSE\_INTERVAL@{PQS\_SERVER\_PAUSE\_INTERVAL}}
\index{PQS\_SERVER\_PAUSE\_INTERVAL@{PQS\_SERVER\_PAUSE\_INTERVAL}!server.h@{server.h}}
\doxysubsubsection{\texorpdfstring{PQS\_SERVER\_PAUSE\_INTERVAL}{PQS\_SERVER\_PAUSE\_INTERVAL}}
{\footnotesize\ttfamily \label{server_8h_a4b3434bd162765ecc049a007fa583cb8} 
\#define PQS\+\_\+\+SERVER\+\_\+\+PAUSE\+\_\+\+INTERVAL~100}



The pause interval used by the server pause function. 

This macro defines the time interval (in milliseconds) during which the server will pause accepting new connection requests. 

\doxysubsection{Function Documentation}
\Hypertarget{server_8h_a464f77940b0c4be43e1f747627c4433f}\index{server.h@{server.h}!pqs\_server\_pause@{pqs\_server\_pause}}
\index{pqs\_server\_pause@{pqs\_server\_pause}!server.h@{server.h}}
\doxysubsubsection{\texorpdfstring{pqs\_server\_pause()}{pqs\_server\_pause()}}
{\footnotesize\ttfamily \label{server_8h_a464f77940b0c4be43e1f747627c4433f} 
PQS\+\_\+\+EXPORT\+\_\+\+API void pqs\+\_\+server\+\_\+pause (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



Pause the server, suspending new joins. 

This function temporarily suspends the server listener so that no new client connections will be accepted. This is useful during maintenance or when shutting down the server.

DOXYGEN\+\_\+\+IGNORE \Hypertarget{server_8h_a77be24f2908514353a01634eb3942e48}\index{server.h@{server.h}!pqs\_server\_quit@{pqs\_server\_quit}}
\index{pqs\_server\_quit@{pqs\_server\_quit}!server.h@{server.h}}
\doxysubsubsection{\texorpdfstring{pqs\_server\_quit()}{pqs\_server\_quit()}}
{\footnotesize\ttfamily \label{server_8h_a77be24f2908514353a01634eb3942e48} 
PQS\+\_\+\+EXPORT\+\_\+\+API void pqs\+\_\+server\+\_\+quit (\begin{DoxyParamCaption}\item[{qsc\+\_\+socket \texorpdfstring{$\ast$}{*}}]{source}{}\end{DoxyParamCaption})}



Quit the server, closing all connections. 

This function terminates the server by closing all active client connections. The provided socket (source) is used as the listener or reference socket which is closed as part of the shutdown process.


\begin{DoxyParams}{Parameters}
{\em source} & A pointer to the server listener socket. \\
\hline
\end{DoxyParams}
\Hypertarget{server_8h_a21ed8451507f44e962e1a24b7d25e5a2}\index{server.h@{server.h}!pqs\_server\_resume@{pqs\_server\_resume}}
\index{pqs\_server\_resume@{pqs\_server\_resume}!server.h@{server.h}}
\doxysubsubsection{\texorpdfstring{pqs\_server\_resume()}{pqs\_server\_resume()}}
{\footnotesize\ttfamily \label{server_8h_a21ed8451507f44e962e1a24b7d25e5a2} 
PQS\+\_\+\+EXPORT\+\_\+\+API void pqs\+\_\+server\+\_\+resume (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



Resume the server listener function from a paused state. 

This function resumes the server\textquotesingle{}s listening operations if it was previously paused. New client connections will again be accepted after this function is called. \Hypertarget{server_8h_a08491dc116cdd550407bc040d555cc26}\index{server.h@{server.h}!pqs\_server\_start\_ipv4@{pqs\_server\_start\_ipv4}}
\index{pqs\_server\_start\_ipv4@{pqs\_server\_start\_ipv4}!server.h@{server.h}}
\doxysubsubsection{\texorpdfstring{pqs\_server\_start\_ipv4()}{pqs\_server\_start\_ipv4()}}
{\footnotesize\ttfamily \label{server_8h_a08491dc116cdd550407bc040d555cc26} 
PQS\+\_\+\+EXPORT\+\_\+\+API \mbox{\hyperlink{pqs_8h_a2c9a6e74f4ff60d25602074a1d70a4e2}{pqs\+\_\+errors}} pqs\+\_\+server\+\_\+start\+\_\+ipv4 (\begin{DoxyParamCaption}\item[{qsc\+\_\+socket \texorpdfstring{$\ast$}{*}}]{source}{, }\item[{const \mbox{\hyperlink{structpqs__server__signature__key}{pqs\+\_\+server\+\_\+signature\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{kset}{, }\item[{void(\texorpdfstring{$\ast$}{*}}]{receive\+\_\+callback~}{)(\mbox{\hyperlink{structpqs__connection__state}{pqs\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t), }\item[{void(\texorpdfstring{$\ast$}{*}}]{disconnect\+\_\+callback~}{)(\mbox{\hyperlink{structpqs__connection__state}{pqs\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*})}\end{DoxyParamCaption})}



Start the IPv4 multi-\/threaded server. 

This function starts the PQS server in a multi-\/threaded mode for IPv4. It initializes the listener socket, performs necessary key exchange operations using the provided server private key, and then spawns threads to handle incoming client data streams and disconnections.


\begin{DoxyParams}{Parameters}
{\em source} & A pointer to the listener server socket. \\
\hline
{\em kset} & \mbox{[}const\mbox{]} A pointer to the QSMP private key (server signature key) used for the key exchange. \\
\hline
{\em receive\+\_\+callback} & A pointer to the callback function that processes client data streams. \\
\hline
{\em disconnect\+\_\+callback} & A pointer to the callback function invoked upon client disconnection.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a \doxylink{pqs_8h_a2c9a6e74f4ff60d25602074a1d70a4e2}{pqs\+\_\+errors} value indicating the success or failure of the server startup and key exchange process. 
\end{DoxyReturn}
\Hypertarget{server_8h_a40ea87dcbc4b998bb1fab22730713822}\index{server.h@{server.h}!pqs\_server\_start\_ipv6@{pqs\_server\_start\_ipv6}}
\index{pqs\_server\_start\_ipv6@{pqs\_server\_start\_ipv6}!server.h@{server.h}}
\doxysubsubsection{\texorpdfstring{pqs\_server\_start\_ipv6()}{pqs\_server\_start\_ipv6()}}
{\footnotesize\ttfamily \label{server_8h_a40ea87dcbc4b998bb1fab22730713822} 
PQS\+\_\+\+EXPORT\+\_\+\+API \mbox{\hyperlink{pqs_8h_a2c9a6e74f4ff60d25602074a1d70a4e2}{pqs\+\_\+errors}} pqs\+\_\+server\+\_\+start\+\_\+ipv6 (\begin{DoxyParamCaption}\item[{qsc\+\_\+socket \texorpdfstring{$\ast$}{*}}]{source}{, }\item[{const \mbox{\hyperlink{structpqs__server__signature__key}{pqs\+\_\+server\+\_\+signature\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{kset}{, }\item[{void(\texorpdfstring{$\ast$}{*}}]{receive\+\_\+callback~}{)(\mbox{\hyperlink{structpqs__connection__state}{pqs\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}, size\+\_\+t), }\item[{void(\texorpdfstring{$\ast$}{*}}]{disconnect\+\_\+callback~}{)(\mbox{\hyperlink{structpqs__connection__state}{pqs\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*})}\end{DoxyParamCaption})}



Start the IPv6 multi-\/threaded server. 

This function starts the PQS server in a multi-\/threaded mode for IPv6. It initializes the listener socket, performs the key exchange using the provided server private key, and spawns threads to handle incoming client data streams.


\begin{DoxyParams}{Parameters}
{\em source} & A pointer to the listener server socket. \\
\hline
{\em kset} & \mbox{[}const\mbox{]} A pointer to the QSMP private key (server signature key) used for the key exchange. \\
\hline
{\em receive\+\_\+callback} & A pointer to the callback function that processes client data streams. \\
\hline
{\em disconnect\+\_\+callback} & A pointer to the callback function invoked upon client disconnection.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a \doxylink{pqs_8h_a2c9a6e74f4ff60d25602074a1d70a4e2}{pqs\+\_\+errors} value indicating the success or failure of the server startup and key exchange process. 
\end{DoxyReturn}
